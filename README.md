# Preset Tracker Enhanced (Beta)

## 소개

Preset Tracker Enhanced는 SillyTavern 확장 기능으로, 각 AI 메시지 또는 스와이프(Swipe) 생성 시 사용된 **프롬프트 정보**를 추적하고 저장하여 사용자가 나중에 참조할 수 있도록 돕습니다.

## 핵심 기능

### 프롬프트 정보 추적 및 저장

*   AI 응답 생성 시 활성화된 **'Generation Preset'** 이름을 자동으로 기록합니다.
*   API 설정이 **'Text Completion'**으로 선택된 경우, Generation Preset 외에도 **'Context Template', 'Instruct Template', 'System Prompt'**의 이름까지 상세하게 기록합니다. (다른 API 유형의 경우 Generation Preset만 기록됩니다.)
*   추적된 정보는 해당 메시지/스와이프의 정보(`send_date`와 `model` 조합 키)와 연결되어 채팅 메타데이터 내 `presetsBySwipeKey`에 **객체(Object)** 형태로 저장됩니다.

### 저장된 정보 확인

*   채팅 로그에서 AI 메시지의 **캐릭터 이름**을 클릭하면, 해당 응답 생성 시 사용된 **모델 이름**과 저장된 **프롬프트 정보**가 Toastr 팝업 알림으로 표시됩니다.

### 최초 설정 기록 원칙

*   이 확장은 메시지나 스와이프가 **처음 생성될 때의 프롬프트 정보만 기록**합니다.

## 부가 기능 (슬래시 커맨드)

*   **데이터 정리 (`/pteCleanOrphanData`):**
    *   채팅에서 메시지나 스와이프를 삭제해도 이 확장 기능이 저장한 관련 프롬프트 기록은 자동으로 삭제되지 않습니다. 채팅 내용을 일부 삭제한 경우, 필요에 따라 이 명령어를 실행하여 현재 채팅에 존재하지 않는 메시지/스와이프에 해당하는 불필요한 기록을 메타데이터에서 수동으로 정리할 수 있습니다.

*   **레거시 데이터 마이그레이션 (`/pteMigratePresetData`):**
    *   초기 버전(Beta1)의 문자열 데이터를 현재의 객체 형식으로 변환합니다. (채팅별 실행 필요. Beta2 버전 이후부터 이 확장 기능을 사용하기 시작했다면 실행할 필요가 없습니다.)

## 알려진 문제점 및 주의사항

*   **정보 정확성 한계:**
    *   프롬프트 정보는 메시지의 `send_date`와 `model` 정보를 조합하여 식별됩니다. SillyTavern 내부 메커니즘 및 사용 환경에 따라 이 조합의 고유성이 완벽하지 않을 수 있습니다.
    *   특히, **매우 짧은 시간 안에 동일 모델로 여러 응답을 생성하면서 그 사이에 설정을 변경**하는 경우, 이 확장 기능의 '최초 기록' 원칙 및 키 생성 방식 때문에 **의도하지 않은 설정 정보가 기록되거나, 특정 응답의 정보가 누락될 수 있습니다.** 이는 현재로서는 기술적인 한계입니다.

*   **'Continue' 기능 사용 시:**
    *   SillyTavern 인터페이스 좌측 하단의 **'Continue'** 버튼을 사용하여 대화를 이어갈 경우, 생성되는 메시지에 대해서는 **이전에 저장된 프롬프트 정보가 정상적으로 연결되지 않아 표시되지 않을 수 있습니다.**